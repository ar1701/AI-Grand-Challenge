#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <unistd.h>

#define USERNAME "admin"
#define PASSWORD "password123"

int generate_session_token() {
    return rand();
}

void login(char *input) {
    char query[256];
    sprintf(query, "SELECT * FROM users WHERE name = '%s';", input);
    printf("Executing query: %s\n", query);
}

void process_input(char *user_input) {
    char buffer[64];
    strcpy(buffer, user_input);
    printf("Received: %s\n", buffer);
}

void debug_log(char *msg) {
    printf(msg);
}

void use_after_free_example() {
    char *data = (char *)malloc(100);
    strcpy(data, "Important data");
    free(data);
    printf("Data: %s\n", data);
}

void double_free_example() {
    char *ptr = malloc(128);
    free(ptr);
    free(ptr);
}

void run_command(char *user_input) {
    char cmd[256];
    snprintf(cmd, sizeof(cmd), "ping -c 1 %s", user_input);
    system(cmd);
}

int main(int argc, char *argv[]) {
    if (argc < 2) {
        printf("Usage: %s <input>\n", argv[0]);
        return 1;
    }

    login(argv[1]);

    process_input(argv[1]);

    debug_log(argv[1]);

    use_after_free_example();
    double_free_example();

    run_command(argv[1]);

    int token = generate_session_token();
    printf("Session token: %d\n", token);

    return 0;
}